(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{479:function(s,t,n){"use strict";n.r(t);var a=n(10),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("blockquote",[n("p",[s._v("修改： 文章修改于2021/3/1日，昨晚半夜写完的第一套方案白天测试的时候不能实现自动Gitee Pages，所以紧急进行了修改，并对整个流程的细节进行了更详细的描述，相信跟着走下来，大家都可以打造出自己超好用的静态博客写作、部署脚本，从此真正将更多的精力投入的写作中！！！")])]),s._v(" "),n("p",[s._v("我的个人博客是通过Github的Pages技术搭建的静态博客，使用 "),n("code",[s._v("vuepress")]),s._v(" 驱动。由于Github在国内环境访问速度慢，并且不够稳定，所以通常对外介绍使用Gitee的镜像博客仓库，但是每次都需要在推送Github之后去Gitee上对应的仓库进行手动同步，就无端增加了很多重复的工作量，经过多方搜索和实践，最终选定了Github一个比较新的技术 -- "),n("code",[s._v("Github Actions")]),s._v(" "),n("strong",[s._v("实现代码自动Build，同步到Gitee，自动在Gitee实现Pages功能")]),s._v("。")]),s._v(" "),n("p",[s._v("下面来看一下如何操作吧：")]),s._v(" "),n("h1",{attrs:{id:"_1-github和gitee添加公钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-github和gitee添加公钥"}},[s._v("#")]),s._v(" 1.Github和Gitee添加公钥")]),s._v(" "),n("h2",{attrs:{id:"window下通过git-bash生成公钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#window下通过git-bash生成公钥"}},[s._v("#")]),s._v(" Window下通过git bash生成公钥")]),s._v(" "),n("p",[s._v("输入 "),n("code",[s._v("ssh-keygen")]),s._v(" ，然后连按三下回车")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-64f9ebb1cfff6c20289786297c495de69a6.png",alt:"生成公钥",title:"生成公钥"}})]),s._v(" "),n("h2",{attrs:{id:"gitee-和-github-添加公钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gitee-和-github-添加公钥"}},[s._v("#")]),s._v(" Gitee 和 Github 添加公钥")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-1b752f913a8dd26c5465e3c7e849586b383.png",alt:"Github 添加SSH ",title:"Github 添加SSH "}})]),s._v(" "),n("h2",{attrs:{id:"检测公钥是否成功添加"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#检测公钥是否成功添加"}},[s._v("#")]),s._v(" 检测公钥是否成功添加")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -T git@github.com\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -T git@gitee.com\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#返回如下图所示结果，则成功添加公钥！")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-c47116a70136263815d14cf472487d39657.png",alt:"SSH公钥添加成功",title:"SSH公钥添加成功"}})]),s._v(" "),n("h1",{attrs:{id:"_2-github仓库添加token"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-github仓库添加token"}},[s._v("#")]),s._v(" 2.Github仓库添加Token")]),s._v(" "),n("ol",[n("li",[s._v("生成账号Token")])]),s._v(" "),n("hr"),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-07210357b78ab191ad5fae4b64eedb3fc0e.png",alt:"Github中Token生成",title:"Github中Token生成"}})]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("在Secret中添加Token")])]),s._v(" "),n("hr"),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-e87a1e6f21d518350b90bd9a5b142c7090f.png",alt:"Secret添加账号Token",title:"Secret添加账号Token"}})]),s._v(" "),n("h1",{attrs:{id:"_3-github仓库添加私钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-github仓库添加私钥"}},[s._v("#")]),s._v(" 3.Github仓库添加私钥")]),s._v(" "),n("ol",[n("li",[s._v("进入Github想要同步的仓库-选择Settings进行设置-选择Secret进行设置")])]),s._v(" "),n("hr"),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-daca3471008d543b708fc528e1ce8b3c9ab.png",alt:"添加仓库Secret",title:"添加仓库Secret"}})]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("创建新的仓库Secret "),n("code",[s._v("GITEE_RSA_PRIVATE_KEY")])])]),s._v(" "),n("hr"),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-94cc86728d23cd3a49e1d2276488b211b31.png",alt:"添加私钥",title:"添加私钥"}})]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[s._v("添加 "),n("code",[s._v("GITEE_PASSWORD")])])]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("同之前一样，在仓库里添加名为 "),n("code",[s._v("GITEE_PASSWORD")]),s._v(" 的Secret，内容是你的Gitee账号密码。")]),s._v(" "),n("p",[s._v("最后检查一下是否在 "),n("code",[s._v("Github")]),s._v(" 中添加了 "),n("code",[s._v("ACCESS_TOKEN")]),s._v(" ，"),n("code",[s._v("GITEE_PASSWORD")]),s._v(" ，"),n("code",[s._v("GITEE_RSA_PRIVATE_KEY")]),s._v(" 三个密钥。如下图：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-0e7232f89a2ee190b962c808f0a2a43090f.png",alt:"成功添加三个密钥的截图",title:"成功添加三个密钥的截图"}})]),s._v(" "),n("h1",{attrs:{id:"👀-重头戏来了"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#👀-重头戏来了"}},[s._v("#")]),s._v(" 👀 重头戏来了！！！")]),s._v(" "),n("p",[s._v("在GitHub仓库里添加 Actions 脚本文件！！")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-3a8e8ba007f8fb448d4cf04f51051b3a735.png",alt:"创建自己的工作流",title:"创建自己的工作流"}})]),s._v(" "),n("ul",[n("li",[s._v("工作流脚本名字可以自定义，随意起！！")]),s._v(" "),n("li",[s._v("复制下面的自动打包及同步脚本")]),s._v(" "),n("li",[s._v("在之后每次"),n("strong",[s._v("有 Push 请求")]),s._v("的时候，该脚本就会自动执行，完成"),n("strong",[s._v("云端Build静态文件")]),s._v("，"),n("strong",[s._v("部署到 gh_pages 分支")]),s._v("，然后将"),n("strong",[s._v("代码同步到 Gitee 的镜像仓库")]),s._v("，并且"),n("strong",[s._v("自动执行 Pages 的 Update 操作")]),s._v("！！！")])]),s._v(" "),n("h1",{attrs:{id:"自动打包及自动同步脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自动打包及自动同步脚本"}},[s._v("#")]),s._v(" 自动打包及自动同步脚本")]),s._v(" "),n("div",{staticClass:"language-Shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("name: A TO A:GH_PAGES\non: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("push"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\njobs:\n  build-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n    - name: Checkout\n      uses: actions/checkout@master\n\n    - name: Build and Deploy\n      uses: jenkey2011/vuepress-deploy@master\n      env:\n        ACCESS_TOKEN: "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${{ secrets.ACCESS_TOKEN }")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 你要操作的目标仓库")]),s._v("\n        TARGET_REPO: china-fanxin/china-fanxin\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建结果存储的分支")]),s._v("\n        TARGET_BRANCH: gh_pages\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要使用的构建命令")]),s._v("\n        BUILD_SCRIPT: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建结果存储目录")]),s._v("\n        BUILD_DIR: docs/.vuepress/dist/\n  sync:\n    needs: build-and-deploy\n    runs-on: ubuntu-latest\n    steps:\n    - name: Sync to Gitee\n      uses: wearerequired/git-mirror-action@master\n      env:\n        SSH_PRIVATE_KEY: "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${{ secrets.GITEE_RSA_PRIVATE_KEY }")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      with:\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 来源仓库")]),s._v("\n        source-repo: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git@github.com:china-fanxin/china-fanxin.git"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标仓库")]),s._v("\n        destination-repo: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git@gitee.com:china-fanxin/china-fanxin.git"')]),s._v("\n  reload-pages:\n    needs: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n    runs-on: ubuntu-latest\n    steps:\n      - name: Build Gitee Pages\n        uses: yanglbme/gitee-pages-action@main\n        with:\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意替换为你的 Gitee 用户名")]),s._v("\n          gitee-username: china-fanxin\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意在 Settings->Secrets 配置 GITEE_PASSWORD")]),s._v("\n          gitee-password: "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${{ secrets.GITEE_PASSWORD }")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意替换为你的 Gitee 仓库，仓库名严格区分大小写，请准确填写，否则会出错")]),s._v("\n          gitee-repo: china-fanxin/china-fanxin\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要部署的分支，默认是 master，若是其他分支，则需要指定（指定的分支必须存在）")]),s._v("\n          branch: gh_pages\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br")])]),n("h1",{attrs:{id:"😍-功能实现效果"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#😍-功能实现效果"}},[s._v("#")]),s._v(" 😍 功能实现效果")]),s._v(" "),n("p",[s._v("完成了上述配置后，就已经可以实现当有代码 Push 到 Github 后，自动将代码 Build 生成静态文件 Pages ，并且将代码同步到Gitee 上，并自动 Pages ！！\n如下的 Actions 执行的结果图！！")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-d04edb445613dd634bace6415a50f5ab9b2.png",alt:"工作流执行结果",title:"工作流执行结果"}})]),s._v(" "),n("blockquote",[n("p",[s._v("文档信息\n版权声明：自由转载-非商用-非衍生-保持署名（创意共享3.0许可证）\n发表日期：2021-03-01 20:42:19 星期一")])]),s._v(" "),n("p",[s._v("更多精彩内容查看我的"),n("a",{attrs:{href:"https://china-fanxin.gitee.io/china-fanxin/",target:"_blank",rel:"nofollow noopener noreferrer"}},[s._v("技术博客"),n("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);